# Compte rendu atelier docker 09/02/2017

## Présent

 * Antoine
 * FLO(web)rian
 * Guillaume
 * Marc
 * Nicolas
 * Robin

## Présentation

Présentation générale des participants + "Qu'attend tu des ateliers docker ?"
Discution sur l'organisation des ateliers :
  * salle: 
  	* pour l'instant on est en salle de réunion pour avoir le video projecteur,
  	* ne pourrait-on pas faire des ateliers au spot ?
  * fréquence des ateliers ?
  * prochains sujets abordés

## Présentation rapide monitoring

  * [Prometheus](https://prometheus.io) : collecteur/aggrégateur 
  * [Grafana](http://grafana.org/) : front 
  * [monitoring gitlab](http://monitor.gitlab.net/) : monitoring instance gitlab (process, database, ...)

### Compose stack monitoring :

```
version: "2"
services:
  prometheus:
    image: prom/prometheus:latest
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    environment:
      - VIRTUAL_HOST=prometheus.[INSERT YOUR DOMAIN]
      - VIRTUAL_PORT=9090
    networks:
      - proxy

  grafana:
    image: grafana/grafana
    environment:
      - VIRTUAL_HOST=grafana.[INSERT YOUR DOMAIN]
      - VIRTUAL_PORT=3000
      - GF_SERVER_ROOT_URL=http://grafana.[INSERT YOUR DOMAIN]
      - GF_SECURITY_ADMIN_PASSWORD=[PASSWORD ADMIN USER]
    networks:
      - proxy

networks:
  proxy:
    external:
      name: proxy

```

### Compose node:

Sur chaque host supervisé:
  * [node-exporter](https://github.com/prometheus/node_exporter) : métriques système
  * [cAdvisor](https://github.com/google/cadvisor) : métriques docker engine

```
version: "2"
services:

  nodeexporter:
    image: prom/node-exporter
    ports:
      - 9100:9100
    restart: always

  cadvisor:
    image: google/cadvisor
    ports:
      - 8080:8080
    volumes:
      - /:/rootfs:ro
      - /var/run:/var/run:rw
      - /sys:/sys:ro
      - /var/lib/docker/:/var/lib/docker:ro
    restart: always

```


## Définitions des sujets des prochains ateliers

L'idée serait d'établir un sujet principal par atelier, l'ordre reste à établir. 

 * 1 présentation toutes les 2/3 semaines ?
 * discution libre sur les autres ateliers ?

Il faudrait que les participants prennent en main un sujet pour pouvoir le présenter lors d'un atelier.

 * Dockerfile : c'est quoi un Dockerfile bien pensé ? C'est quoi des layers ?
 * monitoring
 * gestion prod : continuous deployment / rollback
 * docker and friends : swarm, machine, compose ...
 * securité : namespace / cgroup / WTF c'est root qui lance mon main process, c'est sécure ca ?
 * docker & windows
 
## TODO

 * continuer d'élaborer la liste des "topics".

NOTE: Antoine se charge d'amener les bières !!